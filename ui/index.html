<!DOCTYPE html>
<html>
<head>
  <title>Notes Service UI</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    input, textarea { width: 300px; margin-bottom: 10px; padding: 6px; }
    button { padding: 6px 12px; margin: 5px 0; cursor: pointer; }
    .note { border: 1px solid #ccc; padding: 10px; margin: 10px 0; border-radius: 6px; }
    .note-title { font-weight: bold; }
    .note-id { font-size: 12px; color: #666; }
  </style>
</head>
<body>

<h1>Notes Service</h1>

<h2>Create Note</h2>
<input id="title" placeholder="Title"><br>
<textarea id="content" placeholder="Content"></textarea><br>
<button onclick="createNote()">Create</button>

<h2>All Notes</h2>
<button onclick="loadNotes()">Refresh</button>
<div id="notes"></div>

<script>
const API = "https://notes-service-notes-service-demo.apps-crc.testing";

// -----------------------------
// Create Note
// -----------------------------
async function createNote() {
  const title = document.getElementById("title").value;
  const content = document.getElementById("content").value;

  if (!title) {
    alert("Title is required");
    return;
  }

  await fetch(API, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ title, content })
  });

  document.getElementById("title").value = "";
  document.getElementById("content").value = "";

  loadNotes();
}

// -----------------------------
// Load All Notes
// -----------------------------
async function loadNotes() {
  const res = await fetch(API);
  const notes = await res.json();

  const container = document.getElementById("notes");
  container.innerHTML = "";

  notes.forEach(note => {
    const div = document.createElement("div");
    div.className = "note";

    div.innerHTML = `
      <div class="note-title">${note.title}</div>
      <div class="note-id">ID: ${note.id}</div>
      <p>${note.content || ""}</p>
      <button onclick="editNote('${note.id}', '${note.title}', \`${note.content || ""}\`)">Edit</button>
      <button onclick="deleteNote('${note.id}')">Delete</button>
    `;

    container.appendChild(div);
  });
}

// -----------------------------
// Edit Note
// -----------------------------
function editNote(id, oldTitle, oldContent) {
  const title = prompt("New title:", oldTitle);
  if (title === null) return;

  const content = prompt("New content:", oldContent);
  if (content === null) return;

  updateNote(id, title, content);
}

async function updateNote(id, title, content) {
  await fetch(`${API}/${id}`, {
    method: "PUT",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ title, content })
  });

  loadNotes();
}

// -----------------------------
// Delete Note
// -----------------------------
async function deleteNote(id) {
  if (!confirm("Delete this note?")) return;

  await fetch(`${API}/${id}`, { method: "DELETE" });
  loadNotes();
}

// Load notes on page load
loadNotes();
</script>

</body>
</html>
